<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>MZK RPG - ULTIMATE ELITE 2026</title>

<style>
:root { --primary: #ff2b2b; --bg: #0a0a0a; --card-bg: linear-gradient(145deg, #1a0000, #250000); --gold: #ffd700; --coin: #ff9900; --blue: #0088ff; }
* { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
body { margin: 0; padding: env(safe-area-inset-top) 15px 40px 15px; background: var(--bg); color: #fff; font-family: -apple-system, system-ui, sans-serif; }
#app { max-width: 500px; margin: 0 auto; }
canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 999; }
.banner-img { width: 100%; border-radius: 15px; border: 1px solid var(--primary); margin: 15px 0; box-shadow: 0 0 15px rgba(255,0,0,0.3); }
.top-bar { display: flex; justify-content: space-between; margin-bottom: 10px; font-weight: bold; font-size: 0.75rem; }
.level-card { background: var(--card-bg); border-radius: 12px; padding: 20px; text-align: center; border: 1px solid #330000; margin-bottom: 15px; }
.xp-label { font-size: 1.6rem; font-weight: 900; color: var(--primary); text-shadow: 0 0 10px rgba(255,0,0,0.4); }
h2 { font-size: 0.85rem; color: var(--primary); text-transform: uppercase; margin: 25px 0 8px; border-left: 3px solid var(--primary); padding-left: 10px; }
.card { background: var(--card-bg); padding: 15px; border-radius: 12px; border: 1px solid #330000; margin-bottom: 12px; }
.grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
button { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 800; cursor: pointer; font-size: 0.7rem; }
button:disabled { background: #222; color: #555; }
.bar-bg { background: #1a0000; height: 12px; border-radius: 6px; margin-top: 8px; overflow: hidden; border: 1px solid #300; }
.bar-fill { height: 100%; background: var(--primary); width: 0%; transition: 0.6s; }
.history-item { font-size: 0.65rem; color: #888; padding: 6px 0; border-bottom: 1px solid #1a1a1a; }
.chat-msg { color: var(--gold); font-style: italic; font-weight: bold; }
.inventory-slot { display: inline-block; padding: 5px 10px; background: #222; border: 1px solid var(--gold); border-radius: 4px; margin: 3px; font-size: 0.6rem; color: var(--gold); }
.boss-card { background: linear-gradient(45deg, #000, #400); border: 2px solid var(--primary); display: none; }
.shop-item { background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #444; }
</style>
</head>
<body onclick="initAudio()">

<canvas id="confetti"></canvas>

<div id="app">
    <img src="mzk_banner.png" alt="MZK LOGO" class="banner-img">

    <div class="top-bar">
        <div id="rankBadge">RANK: BRONZE</div>
        <div style="color:var(--coin)">üí∞ <span id="coinsVal">0</span> c</div>
    </div>

    <div id="bossSection" class="card boss-card">
        <h3 style="margin:0; color:var(--primary); font-size:0.8rem">üëæ BOSS: A PREGUI√áA ABISSAL</h3>
        <div class="bar-bg" style="height:20px"><div id="bossHpBar" class="bar-fill" style="width:100%; background:linear-gradient(90deg, #f00, #500)"></div></div>
        <p id="bossStatus" style="font-size:0.6rem; text-align:center; margin-top:5px">HP: 1000/1000</p>
    </div>

    <div class="level-card" id="mainCard">
        <div class="xp-label" id="levelTxt">LVL 1</div>
        <div style="font-size:0.7rem; color:var(--gold)" id="streakTxt">üî• Streak: 0 dias</div>
        <div class="bar-bg"><div id="xpBarFill" class="bar-fill"></div></div>
        <div id="xpStatus" style="font-size: 0.6rem; margin-top: 8px; color: var(--gold); display: none;">‚ö° XP DOBRO ATIVO!</div>
    </div>

    <h2>üõí Mercado & Invent√°rio</h2>
    <div class="card">
        <div class="grid">
            <div class="shop-item">
                <p style="font-size:0.6rem">XP Dobro (1h)<br><b>150 c</b></p>
                <button onclick="buyItem('doubleXp', 150)">COMPRAR</button>
            </div>
            <div class="shop-item">
                <p style="font-size:0.6rem">Ticket Fast Food<br><b>500 c</b></p>
                <button onclick="buyItem('fastFood', 500)">COMPRAR</button>
            </div>
        </div>
        <div id="inventoryList" style="margin-top: 10px; border-top: 1px solid #333; padding-top: 5px;"></div>
    </div>

    <h2>üé≤ Banca do MT_</h2>
    <div class="card">
        <button id="betBtn" onclick="placeBet()" style="background:var(--gold); color:#000; width:100%">APOSTAR 100c NO TREINO DE AMANH√É</button>
        <p id="betStatus" style="font-size:0.6rem; margin-top:5px; text-align:center; color:#888"></p>
    </div>

    <h2>üåç Ranking Global</h2>
    <div class="card" style="padding:5px">
        <table style="width:100%; font-size:0.8rem" id="rankingTable"></table>
    </div>

    <h2>üèãÔ∏è Miss√µes</h2>
    <div class="card">
        <select id="gymType" style="width:100%; background:#000; color:#fff; padding:10px; border-radius:5px; margin-bottom:10px; border:1px solid var(--primary)">
            <option value="Peito">Peito & Tr√≠ceps</option>
            <option value="Costas">Costas & B√≠ceps</option>
            <option value="Pernas">Pernas (Hardcore)</option>
            <option value="Boxe">ü•ä Boxe</option>
        </select>
        <button id="gymBtn" onclick="completeGym()">FINALIZAR TREINO</button>
        <div class="grid" id="dailyTasks" style="margin-top:10px"></div>
    </div>

    <div class="card">
        <h3>üíß √Ågua (3L) <span id="waterVal" style="float:right">0ml</span></h3>
        <div class="grid" style="grid-template-columns: 1fr 1fr 1fr;">
            <button onclick="addWater(250)">+250</button>
            <button onclick="addWater(500)">+500</button>
            <button onclick="addWater(1000)">+1L</button>
        </div>
        <div class="bar-bg"><div id="waterBarFill" class="bar-fill" style="background:var(--blue)"></div></div>
    </div>

    <h2>üèÜ Conquistas</h2>
    <div class="card" id="medalsList" style="display:flex; flex-wrap:wrap; gap:5px; justify-content:center;"></div>

    <h2>üìú Log & Provoca√ß√µes</h2>
    <div class="card" id="historyLog"></div>
</div>

<script>
let audioCtx = null;
let state = { xp: 0, lvl: 1, coins: 0, water: 0, tasks: { gym: false, meals: {} }, streak: 0, lastDate: "", betActive: false, inventory: [], doubleXpActive: false, bossHp: 1000, medals: [], date: new Date().toLocaleDateString() };

let rivals = [{ name: "Pedrin MDM", lvl: 12, xp: 50, streak: 5 }, { name: "Cosmin", lvl: 10, xp: 20, streak: 3 }, { name: "Vitinn", lvl: 8, xp: 70, streak: 2 }, { name: "Mt_", lvl: 6, xp: 40, streak: 10 }];

const trashTalk = {
    PedrinMDM: ["N√£o percas a tua streak!", "Fraco."],
    Mt_: ["Fizeste a aposta? Vou cobrar!", "Aposta mais!", "O dinheiro agora √© meu."],
    Vitinn: ["Bebeste √°gua?", "Foco."]
};

function initAudio() { if(!audioCtx && (window.AudioContext || window.webkitAudioContext)) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function sendNotification(t, b) { if ("Notification" in window && Notification.permission === "granted") new Notification(t, { body: b, icon: 'mzk_banner.png' }); }

function addXP(amount, reason) {
    let final = state.doubleXpActive ? amount * 2 : amount;
    state.xp += final; state.coins += 15;
    if(new Date().getDay() === 0) { state.bossHp = Math.max(0, state.bossHp - final); }
    if(state.xp >= 100) { state.lvl++; state.xp = 0; createConfetti(); }
    checkMedals(); save(); render();
}

function buyItem(item, cost) {
    if(state.coins >= cost) {
        state.coins -= cost;
        if(item === 'doubleXp') { state.doubleXpActive = true; setTimeout(() => { state.doubleXpActive = false; render(); }, 3600000); }
        else state.inventory.push(item === 'fastFood' ? 'üçî Fast Food' : 'üíé Item');
        save(); render();
    } else alert("Sem coins!");
}

function placeBet() {
    if(state.coins >= 100 && !state.betActive) {
        state.coins -= 100; state.betActive = true;
        addHistory("üé≤ MT_: 'Aposta aceite. Treina amanh√£!'", true);
        save(); render();
    }
}

function completeGym() {
    if(!state.tasks.gym) {
        state.tasks.gym = true;
        addXP(50, "Treino Finalizado");
        if(state.betActive) { state.coins += 250; state.betActive = false; addHistory("üí∞ MT_: 'Pagamento feito.'", true); }
    }
}

function addHistory(text, isChat = false) {
    state.history.unshift(`<span class="${isChat ? 'chat-msg' : ''}">${new Date().toLocaleTimeString().slice(0,5)} - ${text}</span>`);
    if(state.history.length > 5) state.history.pop();
}

function updateRivals() {
    rivals.forEach(r => {
        r.xp += Math.floor(Math.random() * 25);
        if(r.xp >= 100) {
            r.lvl++; r.xp = 0;
            if(r.lvl >= state.lvl) {
                const k = r.name.replace("_", "");
                const msg = trashTalk[k] ? trashTalk[k][Math.floor(Math.random()*trashTalk[k].length)] : "Subi!";
                addHistory(`${r.name.toUpperCase()}: "${msg}"`, true);
                sendNotification(`Rival ${r.name}`, msg);
            }
        }
    });
    renderRanking();
}

function checkMedals() {
    if(state.water >= 3000 && !state.medals.includes("H2O")) state.medals.push("H2O");
    if(state.streak >= 3 && !state.medals.includes("FIRE")) state.medals.push("FIRE");
}

function save() { localStorage.setItem('mzk_ultimate_2026', JSON.stringify(state)); }
function load() {
    const saved = localStorage.getItem('mzk_ultimate_2026');
    if(saved) {
        const parsed = JSON.parse(saved);
        if(parsed.date !== new Date().toLocaleDateString()) {
            if(parsed.betActive && !parsed.tasks.gym) { addHistory("üí∏ MT_: 'Perbeste a aposta!'", true); parsed.betActive = false; }
            state = {...parsed, water:0, tasks:{gym:false, meals:{}}, date:new Date().toLocaleDateString()};
            const ontem = new Date(); ontem.setDate(ontem.getDate()-1);
            if(parsed.lastDate === ontem.toLocaleDateString() && parsed.tasks.gym) state.streak++; else state.streak = 0;
            state.lastDate = new Date().toLocaleDateString();
        } else state = parsed;
    }
    render();
}

function render() {
    document.getElementById('levelTxt').innerText = `LVL ${state.lvl}`;
    document.getElementById('streakTxt').innerText = `üî• Streak: ${state.streak} dias`;
    document.getElementById('xpBarFill').style.width = `${state.xp}%`;
    document.getElementById('coinsVal').innerText = state.coins;
    document.getElementById('waterVal').innerText = `${state.water}/3000ml`;
    document.getElementById('waterBarFill').style.width = `${(state.water/3000)*100}%`;
    document.getElementById('xpStatus').style.display = state.doubleXpActive ? 'block' : 'none';
    document.getElementById('betStatus').innerText = state.betActive ? "‚úÖ Aposta Ativa" : "Sem aposta.";
    document.getElementById('bossSection').style.display = new Date().getDay() === 0 ? 'block' : 'none';
    document.getElementById('bossHpBar').style.width = `${(state.bossHp/1000)*100}%`;
    document.getElementById('inventoryList').innerHTML = state.inventory.map(i => `<span class="inventory-slot">${i}</span>`).join('');
    
    const meals = ["Caf√©", "Almo√ßo", "Lanche", "Jantar"];
    document.getElementById('dailyTasks').innerHTML = meals.map(m => `<button onclick="toggleMeal('${m}')" ${state.tasks.meals[m] ? 'disabled' : ''}>${state.tasks.meals[m] ? m+' ‚úî' : m}</button>`).join('');
    document.getElementById('historyLog').innerHTML = state.history.map(h => `<div class="history-item">${h}</div>`).join('');
    
    const medalData = { "H2O": "üíß Mestre da √Ågua", "FIRE": "üî• Impar√°vel" };
    document.getElementById('medalsList').innerHTML = state.medals.map(m => `<div style="background:var(--gold); color:#000; padding:4px 8px; border-radius:4px; font-size:0.6rem; font-weight:bold;">${medalData[m] || m}</div>`).join('');
    
    document.getElementById('gymBtn').disabled = state.tasks.gym;
    renderRanking();
}

function renderRanking() {
    let lb = [...rivals, { name: "VOC√ä", lvl: state.lvl, xp: state.xp, isPlayer: true, streak: state.streak }];
    lb.sort((a,b) => b.lvl - a.lvl);
    document.getElementById('rankingTable').innerHTML = lb.map((p,i) => `<tr class="${p.isPlayer ? 'player-row' : ''}"><td style="padding:8px">${i+1}¬∫</td><td>${p.name} ${p.streak > 2 ? 'üî•' : ''}</td><td style="text-align:right">LVL ${p.lvl}</td></tr>`).join('');
}

function createConfetti() {
    const canvas = document.getElementById('confetti'); const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let p = Array.from({length:30}, () => ({x:Math.random()*canvas.width, y:canvas.height, v:Math.random()*5+2, c:Math.random()*360}));
    function draw() { ctx.clearRect(0,0,canvas.width,canvas.height); p.forEach(p => { p.y -= p.v; ctx.fillStyle=`hsl(${p.c},100%,50%)`; ctx.fillRect(p.x, p.y, 5, 5); }); if(p.length > 0 && p[0].y > -10) requestAnimationFrame(draw); }
    draw();
}

function addWater(v) { state.water = Math.min(state.water + v, 3000); addXP(5, "√Ågua"); }
function toggleMeal(m) { if(!state.tasks.meals[m]) { state.tasks.meals[m] = true; addXP(15, `Refei√ß√£o: ${m}`); } }

window.onload = () => { if ("Notification" in window) Notification.requestPermission(); load(); };
setInterval(updateRivals, 30000);
</script>
</body>
</html>